(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[512],{9482:(e,t,n)=>{"use strict";n.d(t,{default:()=>x});var l=n(5155),a=n(2115),i=n(7496),s=n.n(i);function c(e){let{index:t,text:n}=e;return(0,l.jsxs)("article",{className:"panel p-6",children:[(0,l.jsx)("div",{className:"mb-3 flex items-center justify-between",children:(0,l.jsxs)("h4",{className:"text-sm font-semibold uppercase tracking-wider text-warmGray",children:["Slide ",String(t+1).padStart(3,"0")]})}),(0,l.jsx)("p",{className:"whitespace-pre-line text-center text-2xl font-bold leading-relaxed text-[#131b2e]",children:n})]})}let r={fontSize:64,lineHeight:1.4,verticalPosition:"center",paddingPercent:10,background:"transparent",width:1920,height:1080};async function o(e){var t,n;let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a={...r,...l},i=null!=(t=a.width)?t:1920,s=null!=(n=a.height)?n:1080,c=e.split("\n").map(e=>e.trim()),o=document.createElement("canvas");o.width=i,o.height=s;let d=o.getContext("2d");if(!d)throw Error("Failed to initialize canvas context.");!function(e,t,n,l){if("transparent"===l)return e.clearRect(0,0,t,n);e.fillStyle="black"===l?"#000000":"#ffffff",e.fillRect(0,0,t,n)}(d,i,s,a.background);let u=i*(a.paddingPercent/100),p=i-2*u,x=function(e,t,n,l){let a=n;for(;a>16&&(e.font="700 ".concat(a,'px "Pretendard", "Noto Sans KR", sans-serif'),t.some(t=>e.measureText(t).width>l));)a-=2;return a}(d,c,a.fontSize,p),m=x*a.lineHeight,h=x+(c.length-1)*m,b=("center"===a.verticalPosition?s/2:.72*s)-h/2+x/2;d.fillStyle="black"===a.background?"#ffffff":"#111827",d.textAlign="center",d.textBaseline="middle",d.font="700 ".concat(x,'px "Pretendard", "Noto Sans KR", sans-serif'),c.forEach((e,t)=>{d.fillText(e,i/2,b+t*m,p)});let f=await new Promise(e=>{o.toBlob(t=>e(t),"image/png")});if(!f)throw Error("Canvas export failed.");return f}function d(e,t){let n=URL.createObjectURL(e),l=document.createElement("a");l.href=n,l.download=t,l.click(),URL.revokeObjectURL(n)}function u(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"text/plain;charset=utf-8";d(new Blob([e],{type:n}),t)}function p(e){return e.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&apos;")}function x(e){let{song:t}=e,[n,i]=(0,a.useState)(64),[r,x]=(0,a.useState)(1.4),[m,h]=(0,a.useState)("center"),[b,f]=(0,a.useState)(10),[g,j]=(0,a.useState)("transparent"),[N,v]=(0,a.useState)(!1),[w,y]=(0,a.useState)(null),[S,P]=(0,a.useState)(null),[k,_]=(0,a.useState)(0),C=(0,a.useMemo)(()=>t.title.replace(/[^\w\u3131-\uD79D]+/g,"_"),[t.title]),T={fontSize:n,lineHeight:r,verticalPosition:m,paddingPercent:b,background:g},M=async e=>{let n=t.two_line_units[e];if(n){y("png-".concat(e)),P(null);try{let t=await o(n,T),l="".concat(C,"_").concat(String(e+1).padStart(3,"0"),".png");d(t,l),P("PNG slide ".concat(e+1," downloaded."))}finally{y(null)}}},L=async()=>{y("zip"),P(null);try{let e=new(s());for(let n=0;n<t.two_line_units.length;n+=1){let l=t.two_line_units[n],a=await o(l,T),i="".concat(C,"_").concat(String(n+1).padStart(3,"0"),".png");e.file(i,a)}let n=await e.generateAsync({type:"blob"});d(n,"".concat(C,"_slides.zip")),P("ZIP downloaded.")}finally{y(null)}};return(0,l.jsxs)("div",{className:"grid gap-6 lg:grid-cols-[1fr_340px]",children:[(0,l.jsx)("section",{className:"space-y-4",children:t.two_line_units.map((e,t)=>(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsx)(c,{index:t,text:e}),(0,l.jsx)("div",{className:"flex justify-end",children:(0,l.jsx)("button",{type:"button",onClick:()=>M(t),className:"btn-secondary",disabled:!!w,children:w==="png-".concat(t)?"Generating...":"Download PNG ".concat(String(t+1).padStart(3,"0"))})})]},"".concat(e,"-").concat(t)))}),(0,l.jsxs)("aside",{className:"panel h-fit space-y-5 p-5",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-base font-semibold text-[#131b2e]",children:"Export"}),(0,l.jsx)("p",{className:"mt-1 text-sm text-slate-600",children:"TXT, PNG(1920x1080), ProPresenter XML"})]}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsx)("button",{type:"button",className:"btn-primary w-full",onClick:()=>{u(t.two_line_units.join("\n\n"),"".concat(C,".txt")),P("TXT downloaded.")},children:"Download TXT"}),(0,l.jsx)("button",{type:"button",className:"btn-primary w-full",onClick:()=>{u(function(e,t){var n,l;let a=[...e.two_line_units];t.includeTitleSlide&&a.unshift(e.title);let i=a.map((e,n)=>'    <Slide index="'.concat(n+1,'">\n      <Background>').concat(t.background,"</Background>\n      <Text>").concat(e.split("\n").map(e=>p(e)).join("<br/>"),"</Text>\n    </Slide>")).join("\n");return'<?xml version="1.0" encoding="UTF-8"?>\n<ProPresenterPresentation version="7">\n  <Meta>\n    <Title>'.concat(p(e.title),"</Title>\n    <Artist>").concat(p(null!=(n=e.artist)?n:""),"</Artist>\n    <CCLI>").concat(p(null!=(l=e.ccli_number)?l:""),"</CCLI>\n  </Meta>\n  <Slides>\n").concat(i,"\n  </Slides>\n</ProPresenterPresentation>\n")}(t,{includeTitleSlide:N,background:g}),"".concat(C,"_Pro7.xml"),"application/xml;charset=utf-8"),P("ProPresenter XML downloaded.")},children:"Export ProPresenter XML"}),(0,l.jsx)("button",{type:"button",className:"btn-primary w-full",disabled:"zip"===w,onClick:L,children:"zip"===w?"Generating ZIP...":"Download All PNG as ZIP"})]}),(0,l.jsxs)("div",{className:"space-y-4 border-t border-slate-200 pt-4",children:[(0,l.jsx)("h4",{className:"text-sm font-semibold uppercase tracking-wider text-warmGray",children:"PNG Options"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"label",children:"Font Size (24-120)"}),(0,l.jsx)("input",{className:"input",type:"number",min:24,max:120,value:n,onChange:e=>i(Math.min(120,Math.max(24,Number(e.target.value))))})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"label",children:"Line Height (1.2-2.0)"}),(0,l.jsx)("input",{className:"input",type:"number",step:.1,min:1.2,max:2,value:r,onChange:e=>x(Math.min(2,Math.max(1.2,Number(e.target.value)||1.4)))})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"label",children:"Vertical Position"}),(0,l.jsxs)("select",{className:"input",value:m,onChange:e=>h(e.target.value),children:[(0,l.jsx)("option",{value:"center",children:"Center"}),(0,l.jsx)("option",{value:"lower",children:"Lower"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"label",children:"Padding (5%-20%)"}),(0,l.jsx)("input",{className:"input",type:"number",min:5,max:20,value:b,onChange:e=>f(Math.min(20,Math.max(5,Number(e.target.value))))})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"label",children:"Background (PNG/XML)"}),(0,l.jsxs)("select",{className:"input",value:g,onChange:e=>j(e.target.value),children:[(0,l.jsx)("option",{value:"transparent",children:"Transparent"}),(0,l.jsx)("option",{value:"black",children:"Black"}),(0,l.jsx)("option",{value:"white",children:"White"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"label",children:"Single PNG from Slide"}),(0,l.jsx)("select",{className:"input",value:k,onChange:e=>_(Number(e.target.value)),children:t.two_line_units.map((e,t)=>(0,l.jsx)("option",{value:t,children:String(t+1).padStart(3,"0")},t))}),(0,l.jsx)("button",{type:"button",className:"btn-secondary mt-2 w-full",onClick:()=>M(k),disabled:!!w,children:"Download Selected PNG"})]}),(0,l.jsxs)("label",{className:"flex items-center gap-2 text-sm text-slate-700",children:[(0,l.jsx)("input",{type:"checkbox",checked:N,onChange:e=>v(e.target.checked)}),"Include title slide in XML"]})]}),S?(0,l.jsx)("p",{className:"text-sm font-medium text-[#1f57d9]",children:S}):null]})]})}},9914:(e,t,n)=>{Promise.resolve().then(n.bind(n,9482))}},e=>{e.O(0,[496,441,255,358],()=>e(e.s=9914)),_N_E=e.O()}]);