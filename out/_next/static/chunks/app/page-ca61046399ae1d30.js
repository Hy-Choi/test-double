(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{208:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>f});var n=r(5155),l=r(2619),s=r.n(l),i=r(2115),a=r(1296),o=r(4484);let c="two-line-theme";function u(e){"undefined"!=typeof document&&(document.documentElement.dataset.theme=e)}function d(){let[e,t]=(0,i.useState)("light");(0,i.useEffect)(()=>{var e;let r=null!=(e=function(){let e=window.localStorage.getItem(c);return"dark"===e||"light"===e?e:null}())?e:"light";t(r),u(r)},[]);let r="light"===e?"Dark":"Light";return(0,n.jsx)("button",{type:"button",onClick:()=>{let r="light"===e?"dark":"light";t(r),u(r),window.localStorage.setItem(c,r)},className:"rounded-[2px] border-2 border-[var(--border-strong)] bg-[var(--panel-solid)] px-3 py-1.5 text-xs font-semibold uppercase tracking-[0.08em] text-[var(--text-strong)] transition hover:border-[var(--primary)] hover:text-[var(--primary)]","aria-label":"Switch to ".concat(r," mode"),children:r})}let h=["입례","주의 은혜","예배하는 자 되어","새벽예배"],x={title_exact:100,title_partial:60,chorus_weight:55,verse1_weight:45,lyrics_weight:20,unit_weight:15,fuzzy_weight:10};function m(e){var t,r,n,l,s;let i=null==(t=e.song.lyrics_full)?void 0:t.trim();if(i)return i;let a=Array.isArray(e.song.two_line_units)?e.song.two_line_units.map(e=>e.trim()).filter(Boolean):[];if(a.length>0)return a.join("\n\n");let o=null!=(l=null==(r=e.song.chorus_first_line)?void 0:r.trim())?l:"",c=null!=(s=null==(n=e.song.verse1_first_line)?void 0:n.trim())?s:"";return o&&c?"".concat(o,"\n").concat(c):o||c||"가사 정보가 없습니다."}function f(){let{query:e,setQuery:t,results:r,loading:l,error:c,searchNow:u}=(0,a.P)({initialWeights:x,includeSuggestions:!1}),[f,p]=(0,i.useState)(null),[g,v]=(0,i.useState)(null),w=(0,i.useRef)(null),b=e.trim().length>0,y=async(e,t)=>{try{var r;if(null==(r=navigator.clipboard)?void 0:r.writeText)await navigator.clipboard.writeText(t);else{let e=document.createElement("textarea");e.value=t,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)}p(e),window.setTimeout(()=>p(t=>t===e?null:t),1200)}catch(e){p(null)}},j=()=>{null!==w.current&&(window.clearTimeout(w.current),w.current=null)},_=()=>{j(),w.current=window.setTimeout(()=>{v(null)},70)},N=(e,t,r)=>{j();let n=e.currentTarget.getBoundingClientRect(),l=window.innerWidth-460-12,s=Math.max(12,Math.min(n.left,l)),i=n.bottom+4;i+320>window.innerHeight-12&&(i=Math.max(12,n.top-320-4)),v({key:r,title:t.song.title,text:m(t),left:s,top:i})};return(0,i.useEffect)(()=>()=>j(),[]),(0,n.jsxs)("section",{className:"relative -mx-6 flex min-h-screen flex-col overflow-hidden px-7 py-8 text-[var(--text)] md:px-10",children:[(0,n.jsxs)("header",{className:"flex items-center justify-between",children:[(0,n.jsxs)(s(),{href:"/",className:"inline-flex items-center gap-2",children:[(0,n.jsx)("svg",{viewBox:"0 0 48 48",className:"h-7 w-7 text-[var(--text-strong)]",fill:"none","aria-hidden":!0,children:(0,n.jsx)("path",{d:"M42.4 44S36.1 33.9 41.2 24C46.9 12.9 42.2 4 42.2 4H7s4.6 8.9-1 20c-5.1 9.9 1.3 20 1.3 20h35.1Z",fill:"currentColor"})}),(0,n.jsx)("span",{className:"text-lg font-medium uppercase tracking-[0.2em] text-[var(--text-soft)]",children:"TwoLine"})]}),(0,n.jsxs)("nav",{className:"flex items-center gap-3 text-sm text-[var(--text-muted)] md:gap-7",children:[(0,n.jsx)(d,{}),(0,n.jsx)(s(),{href:"/admin/song-new",className:"hidden transition hover:text-[var(--primary)] sm:inline",children:"Add Song"}),(0,n.jsx)(s(),{href:"/admin/search-weight",className:"flex h-9 w-9 items-center justify-center rounded-xl bg-[var(--chip-bg)] text-[var(--chip-text)] transition hover:scale-[1.03] hover:text-[var(--primary)]","aria-label":"관리 설정",children:"☰"})]})]}),(0,n.jsx)("main",{className:"flex flex-1 items-center justify-center",children:(0,n.jsxs)("div",{className:"w-full max-w-[980px] space-y-8 pb-24",children:[(0,n.jsx)("div",{className:"space-y-2 text-center",children:(0,n.jsx)("h1",{className:"text-4xl font-extrabold tracking-tight text-[var(--text-strong)] md:text-6xl",children:"예배 자막을 더 빠르게."})}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("form",{onSubmit:e=>{e.preventDefault(),u()},children:(0,n.jsxs)("div",{className:"flex items-center rounded-[2px] border-2 border-[var(--border-strong)] bg-[var(--input-bg)] shadow-[var(--shadow-hard)]",children:[(0,n.jsx)("div",{className:"pl-4 text-[var(--text-strong)]",children:(0,n.jsxs)("svg",{viewBox:"0 0 24 24",className:"h-6 w-6",fill:"none",stroke:"currentColor",strokeWidth:"2.4","aria-hidden":!0,children:[(0,n.jsx)("circle",{cx:"11",cy:"11",r:"6"}),(0,n.jsx)("path",{d:"m20 20-3.6-3.6"})]})}),(0,n.jsx)("input",{className:"w-full border-none bg-transparent px-4 py-5 text-lg font-medium text-[var(--input-text)] outline-none placeholder:text-[var(--input-placeholder)]",placeholder:"곡 제목, 가수명, 단체명 또는 가사를 입력하세요",value:e,onChange:e=>t(e.target.value),autoComplete:"off"}),(0,n.jsx)("button",{type:"submit","aria-label":"검색",className:"mr-2 inline-flex h-12 w-12 items-center justify-center rounded-[2px] bg-[var(--primary)] text-white transition hover:bg-[var(--primary-hover)]",children:(0,n.jsxs)("svg",{viewBox:"0 0 24 24",className:"h-5 w-5",fill:"none",stroke:"currentColor",strokeWidth:"2.6","aria-hidden":!0,children:[(0,n.jsx)("circle",{cx:"11",cy:"11",r:"6"}),(0,n.jsx)("path",{d:"m20 20-3.6-3.6"})]})})]})}),(0,n.jsxs)("div",{"aria-hidden":!b,className:"absolute left-0 right-0 top-full z-20 mt-1 rounded-2xl border border-[var(--border)] bg-[var(--panel)] p-4 shadow-[var(--shadow-soft)] backdrop-blur-md transition-all duration-200 ease-out ".concat(b?"pointer-events-auto translate-y-0 scale-100 opacity-100":"pointer-events-none -translate-y-2 scale-[0.98] opacity-0"),children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("p",{className:"text-sm font-bold text-[var(--text-strong)]",children:["실시간 검색 결과 (",r.length,")"]}),l?(0,n.jsx)("span",{className:"text-xs text-[var(--text-muted)]",children:"검색 중..."}):null]}),c?(0,n.jsx)("p",{className:"mt-2 text-sm font-medium text-red-600",children:c}):null,l||c||0!==r.length?null:(0,n.jsx)("p",{className:"mt-3 text-sm text-[var(--text-soft)]",children:"일치하는 곡이 없습니다."}),r.length>0?(0,n.jsx)("div",{className:"mt-3 max-h-[360px] space-y-2 overflow-y-auto pr-1",children:r.slice(0,12).map((e,t)=>{let r=function(e){var t,r,n,l;let s=Array.isArray(e.song.two_line_units)&&e.song.two_line_units.find(e=>e.trim().length>0);if(s){let e=s.split("\n").map(e=>e.trim()).filter(Boolean);if(e.length>=2)return"".concat(e[0],"\n").concat(e[1])}let i=null!=(n=null==(t=e.song.chorus_first_line)?void 0:t.trim())?n:"",a=null!=(l=null==(r=e.song.verse1_first_line)?void 0:r.trim())?l:"";return i&&a?"".concat(i,"\n").concat(a):i||a||"가사 정보가 없습니다."}(e),l=m(e),i="".concat(e.song.id,"-").concat(t);return(0,n.jsx)("div",{className:"rounded-xl border border-[var(--border)] bg-[var(--panel-solid)] px-3 py-3 transition-colors",children:(0,n.jsxs)("div",{className:"grid gap-3 md:grid-cols-[190px_1fr_auto] md:items-center",children:[(0,n.jsxs)("div",{className:"min-w-0",children:[(0,n.jsx)("p",{className:"truncate text-[11px] font-medium text-[var(--text-muted)]",children:(0,o.b)(e.song)}),(0,n.jsx)(s(),{href:"/song/".concat(encodeURIComponent(e.song.id),"/"),prefetch:!1,className:"block truncate text-base font-bold text-[var(--text-strong)] hover:underline",children:e.song.title})]}),(0,n.jsx)("div",{className:"min-w-0",children:(0,n.jsx)(s(),{href:"/song/".concat(encodeURIComponent(e.song.id),"/"),prefetch:!1,className:"block whitespace-pre-line text-sm font-medium leading-relaxed text-[var(--text-soft)] transition hover:text-[var(--primary)]",onMouseEnter:t=>N(t,e,i),onMouseLeave:_,onFocus:t=>N(t,e,i),onBlur:_,children:r})}),(0,n.jsx)("button",{type:"button",className:"btn-secondary w-full px-4 py-2 text-xs md:w-auto",onClick:()=>void y(i,l),children:f===i?"복사됨":"바로 복사"})]})},i)})}):null]})]}),g?(0,n.jsxs)("div",{className:"lyrics-popup-surface animate-lyrics-popup fixed z-40 w-[min(460px,calc(100vw-1.5rem))] rounded-2xl border p-4 backdrop-blur-xl",style:{left:"".concat(g.left,"px"),top:"".concat(g.top,"px")},onMouseEnter:j,onMouseLeave:_,children:[(0,n.jsxs)("div",{className:"mb-2 flex items-center justify-between gap-3",children:[(0,n.jsx)("p",{className:"truncate text-sm font-bold text-[var(--text-strong)]",children:g.title}),(0,n.jsx)("button",{type:"button","aria-label":"전체 가사 복사",title:"전체 가사 복사",className:"inline-flex h-8 w-8 items-center justify-center rounded-md border border-[var(--border)] text-[var(--text-strong)] transition hover:border-[var(--primary)] hover:text-[var(--primary)]",onClick:()=>void y("".concat(g.key,"-full"),g.text),children:f==="".concat(g.key,"-full")?(0,n.jsx)("svg",{viewBox:"0 0 24 24",className:"h-4 w-4",fill:"none",stroke:"currentColor",strokeWidth:"2.4","aria-hidden":!0,children:(0,n.jsx)("path",{d:"m5 12 4 4L19 6"})}):(0,n.jsxs)("svg",{viewBox:"0 0 24 24",className:"h-4 w-4",fill:"none",stroke:"currentColor",strokeWidth:"2.2","aria-hidden":!0,children:[(0,n.jsx)("rect",{x:"9",y:"9",width:"11",height:"11",rx:"2"}),(0,n.jsx)("path",{d:"M5 15V6a2 2 0 0 1 2-2h9"})]})})]}),(0,n.jsx)("p",{className:"max-h-72 overflow-y-auto whitespace-pre-line text-sm leading-relaxed text-[var(--text)]",children:g.text})]}):null,(0,n.jsxs)("div",{className:"flex flex-wrap items-center justify-center gap-x-7 gap-y-3 pt-2 text-sm",children:[(0,n.jsx)("span",{className:"font-semibold uppercase tracking-[0.12em] text-[var(--text-muted)]",children:"Trending:"}),h.map(e=>(0,n.jsx)("button",{type:"button",onClick:()=>t(e),className:"border-b-2 border-transparent font-bold text-[var(--text-strong)] transition hover:border-[var(--primary)]",children:e},e))]})]})}),(0,n.jsx)("footer",{className:"mt-auto border-t border-[var(--header-border)] py-8",children:(0,n.jsxs)("div",{className:"flex flex-col items-center justify-between gap-6 text-[11px] font-semibold uppercase tracking-[0.12em] text-[var(--text-muted)] md:flex-row",children:[(0,n.jsxs)("div",{className:"flex items-center gap-6",children:[(0,n.jsx)(s(),{href:"#",className:"transition hover:text-[var(--primary)]",children:"Privacy"}),(0,n.jsx)(s(),{href:"#",className:"transition hover:text-[var(--primary)]",children:"Terms"}),(0,n.jsx)(s(),{href:"#",className:"transition hover:text-[var(--primary)]",children:"Contact"})]}),(0,n.jsx)("p",{children:"\xa9 2026 TwoLineLyrics"}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{children:"KO"}),(0,n.jsx)("span",{className:"h-2 w-2 rounded-full bg-[#20bd65]"}),(0,n.jsx)("span",{children:"Operational"})]})]})}),(0,n.jsx)("div",{className:"pointer-events-none absolute right-0 top-0 -z-10 h-72 w-72 translate-x-1/3 -translate-y-1/3 rounded-full bg-[var(--bg-glow-a)] blur-[100px]"}),(0,n.jsx)("div",{className:"pointer-events-none absolute bottom-0 left-0 -z-10 h-72 w-72 -translate-x-1/3 translate-y-1/3 rounded-full bg-[var(--bg-glow-b)] blur-[100px]"})]})}},1296:(e,t,r)=>{"use strict";r.d(t,{P:()=>x});var n=r(2115);let l={title_exact:100,title_partial:60,chorus_weight:55,verse1_weight:45,lyrics_weight:20,unit_weight:15,fuzzy_weight:10};function s(e){return"string"!=typeof e?"":e.normalize("NFC").replace(/\s+/g," ").trim().toLowerCase()}function i(e,t){let r=s(e);if(!r||!t)return!1;if(r.includes(t))return!0;let n=t.split(" ").filter(Boolean);return!(n.length<=1)&&n.every(e=>r.includes(e))}function a(e,t,r){let n=[],l=0,a=s(t),o=s(e.title);return a&&(o===a?(l+=r.title_exact,n.push("title_exact")):o.includes(a)&&(l+=r.title_partial,n.push("title_partial")),i(e.chorus_first_line,a)&&(l+=r.chorus_weight,n.push("chorus_first_line")),i(e.verse1_first_line,a)&&(l+=r.verse1_weight,n.push("verse1_first_line")),i(e.lyrics_full,a)&&(l+=r.lyrics_weight,n.push("lyrics_full")),(Array.isArray(e.two_line_units)?e.two_line_units:[]).some(e=>i(e,a))&&(l+=r.unit_weight,n.push("two_line_units"))),{score:l,matchedFields:n}}function o(e){return{...l,...null!=e?e:{}}}let c=new Map,u=null,d=null;async function h(){if(u)return u;if(d)return d;d=(async()=>{let e=await fetch("/data/songs.json",{cache:"no-store"});if(!e.ok)throw Error("Failed to load songs.json (".concat(e.status,")"));let t=await e.json();if(!Array.isArray(t))throw Error("Invalid songs.json format: expected an array");return u=t})();try{return await d}finally{d=null}}function x(e){var t,r,l;let i=null!=(t=e.debounceMs)?t:120,u=null!=(r=e.cacheTtlMs)?r:2e4,d=null!=(l=e.includeSuggestions)&&l,[x,m]=(0,n.useState)(""),[f,p]=(0,n.useState)([]),[g,v]=(0,n.useState)([]),[w,b]=(0,n.useState)(e.initialWeights),[y,j]=(0,n.useState)(!1),[_,N]=(0,n.useState)(null),k=(0,n.useRef)(0),C=(0,n.useRef)(null),S=(0,n.useRef)(null),A=(0,n.useRef)(new Map),M=(0,n.useCallback)(()=>{k.current+=1,S.current=null,p([]),v([]),j(!1),N(null)},[]),E=(0,n.useCallback)(t=>{var r,n,l;p(null!=(r=t.results)?r:[]),v(null!=(n=t.suggestions)?n:[]),b(null!=(l=t.weights)?l:e.initialWeights),N(null)},[e.initialWeights]),T=(0,n.useCallback)(async(t,r,n)=>{if(S.current===r)return;let l=k.current+1;k.current=l,S.current=r,n||(j(!0),N(null));try{let n=await h();if(l!==k.current)return;let i=e.initialWeights,x=(function(e,t,r){let n=o(r);return e.map(e=>{let{score:r,matchedFields:l}=a(e,t,n);return{song:e,score:r,matched_fields:l}}).filter(e=>e.score>0).sort((e,t)=>t.score-e.score||e.song.title.localeCompare(t.song.title))})(n,t,i).slice(0,50),m=d?function(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,l=s(t);if(!l)return[];let i=o(r),c=Math.max(1,Math.floor(.45*l.length));return e.map(e=>{let t=function(e,t){let r=s(t),n=s(e.title);if(!r||!n)return 1/0;if(n===r)return 0;if(!n.length)return r.length;if(!r.length)return n.length;let l=Array.from({length:n.length+1},(e,t)=>Array.from({length:r.length+1},(e,r)=>0===t?r:0===r?t:0));for(let e=1;e<=n.length;e+=1)for(let t=1;t<=r.length;t+=1){let s=+(n[e-1]!==r[t-1]);l[e][t]=Math.min(l[e-1][t]+1,l[e][t-1]+1,l[e-1][t-1]+s)}return l[n.length][r.length]}(e,l);if(!(t<=c))return null;let{score:r}=a(e,l,i),n=r+i.fuzzy_weight;return{song_id:e.id,title:e.title,score:n,distance:t}}).filter(e=>!!e).sort((e,t)=>t.score-e.score||e.distance-t.distance||e.title.localeCompare(t.title)).slice(0,n)}(n,t,i,8):[],f={query:t,weights:i,results:x,suggestions:m};E(f);let p=Date.now();c.set(r,{expiresAt:p+u,fetchedAt:p,payload:f}),A.current.set(r,p)}catch(e){if(l!==k.current)return;n||(p([]),v([]),N(e instanceof Error?e.message:"Unknown error"))}finally{l!==k.current||n||j(!1),S.current===r&&(S.current=null)}},[E,u,d,e.initialWeights]),z=(0,n.useCallback)(async(e,t)=>{var r,n;let l=e.trim();if(!l)return void M();let s=function(e,t){let r=e.trim().normalize("NFC").toLowerCase();return"".concat(t?"1":"0",":").concat(r)}(l,d),i=Date.now();for(let[e,t]of c.entries())t.fetchedAt+12e4<=i&&c.delete(e);for(;c.size>120;){let e=c.keys().next().value;if(!e)break;c.delete(e)}let a=c.get(s);t&&a&&(E(a.payload),j(!1));let o=!!(a&&a.expiresAt>i),u=null!=(n=null!=(r=A.current.get(s))?r:null==a?void 0:a.fetchedAt)?n:0;if(t&&o){i-u>350&&S.current!==s&&T(l,s,!0);return}(!t||S.current!==s)&&(t&&i-u<=350||await T(l,s,t&&!!a))},[E,T,d,M]);(0,n.useEffect)(()=>(null!==C.current&&(window.clearTimeout(C.current),C.current=null),x.trim())?(C.current=window.setTimeout(()=>{z(x,!0)},i),()=>{null!==C.current&&(window.clearTimeout(C.current),C.current=null)}):void M(),[i,x,M,z]),(0,n.useEffect)(()=>()=>{null!==C.current&&window.clearTimeout(C.current)},[]);let W=(0,n.useCallback)(async()=>{await z(x,!0)},[x,z]);return{query:x,setQuery:m,results:f,suggestions:g,weights:w,loading:y,error:_,searchNow:W}}},3452:(e,t,r)=>{Promise.resolve().then(r.bind(r,208))},4484:(e,t,r)=>{"use strict";function n(e){return e?e.trim():""}function l(e){let t=n(e.artist),r=n(e.ccli_number),l=n(e.copyright_holder),s=[];return(t&&s.push(t),r&&s.push("CCLI ".concat(r)),l&&s.push(l),0===s.length)?"Unknown Artist":s.join(" \xb7 ")}r.d(t,{b:()=>l})}},e=>{e.O(0,[619,441,255,358],()=>e(e.s=3452)),_N_E=e.O()}]);